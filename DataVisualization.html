<html>
<script defer>
    let str = '';
    function __(v) {
        try {
            str += v;
        } catch {
            console.error('Failed to parse', v)
        }
    }
    function Atable(headings, body) {
        if (!body.length) {
            return '[]'
        }
        return `<table border=1>
    <thead><tr>${headings.map(c => `<td style="font-weight: 600;">${c}</td>`)}</tr></thead>
    <tbody>
    ${body.map((c) => `<tr>${headings.map(h => `<td>${Array.isArray(c[h]) ? Atable(Object.keys(c[h]?.[0] || []), c[h]) :
            typeof c[h] === 'object' && c[h] != null
                ? Otable(c[h])
                : c[h]}
    </td>`)}</tr>`)}
    </tbody>
    </table>`
    }
    function Otable(obj) {
        return `<table border=1>
    <tbody>
    ${Object.keys(obj).map((c) => `<tr><td style="font-weight: 600;">${c}</td><td>${Array.isArray(obj[c]) ? Atable(Object.keys(obj[c]?.[0] || []), obj[c]) :
            typeof obj[c] === 'object' && obj[c] != null
                ? Otable(obj[c])
                : (obj[c] || '""')}</td></tr>`)}
    </tbody>
    </table>`
    }
    const click = () => {
        const data = document.getElementById('data-table').value;
        const root = document.getElementById('root');
        try {
            __(Otable(JSON.parse(data)))
        } catch (e) {
            console.log(e)
        }
        root.innerHTML = str;
        // __(Otable(c))
    }
    document.addEventListener('DOMContentLoaded', (event) => {
        document.title = 'Update';

        document.getElementById('generate').addEventListener('click', click)
        document.getElementById('data-table').addEventListener('keydown', (e) => {
            if (e.code === 'Enter') {
                click();
            }
        })
    })

</script>

<body>
    <div><textarea id='data-table' style="width: 80%; height: 100px;"></textarea></div>
    <button id='generate'>GenerateTable</button>
    <div id='root'></div>
</body>

</html>